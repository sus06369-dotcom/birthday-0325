 <!DOCTYPE html>
<html lang="zh-Hant">
<head>
<meta charset="utf-8" />
<meta name="viewport" content="width=device-width,initial-scale=1" />
<title>ç”Ÿæ—¥å°é©šå–œ Part 2</title>

<!-- Google Font -->
<link href="https://fonts.googleapis.com/css2?family=Noto+Sans+TC:wght@700&display=swap" rel="stylesheet">

<style>
  :root{
    --fg:#4b0082;
    --bgA:#d8b4fe;
    --bgB:#fbc2eb;
  }

  html,body{height:100%;margin:0;padding:0;}
  body{
    min-height:100vh;
    background: linear-gradient(to right, var(--bgA), var(--bgB));
    font-family: 'Noto Sans TC', sans-serif;
    overflow:hidden;
    color:var(--fg);
    position:relative;
  }

  .slide{
    position:fixed;
    inset:0;
    display:flex;
    align-items:center;
    justify-content:center;
    pointer-events:none;
  }

  .message{
    text-align:center;
    max-width:90%;
    padding:0 12px;
    color:var(--fg);
    font-weight:700;
    white-space: nowrap;
    overflow:hidden;
  }

  .message.text{
    font-size: clamp(28px, 7.5vw, 72px);
    animation: textZoomIn 2s forwards;
  }

  @keyframes textZoomIn{
    0%   { opacity:0; transform: scale(0.5); }
    25%  { opacity:1; transform: scale(1.25); }
    55%  { opacity:1; transform: scale(1); }
    100% { opacity:1; transform: scale(1); }
  }

  .message.number{
    font-size: clamp(64px, 28vw, 220px);
    animation: numberZoomFade 2s forwards;
  }

  @keyframes numberZoomFade{
    0%   { opacity:0; transform: scale(0.5); }
    25%  { opacity:1; transform: scale(1.25); }
    55%  { opacity:1; transform: scale(1); }
    90%  { opacity:1; transform: scale(1); }
    100% { opacity:0; transform: scale(1); }
  }

  .confetti{
    position: fixed;
    top: -18px;
    width:10px; height:10px;
    border-radius:3px;
    opacity:0.95;
    z-index: 5;
    pointer-events:none;
    will-change: transform;
    animation: confettiFall linear forwards;
  }

  @keyframes confettiFall{
    to { transform: translateY(110vh) translateX(var(--drift,0px)) rotate(720deg); }
  }

  /* ğŸ‚ è›‹ç³•å®¹å™¨ */
  #cakeWrapper{
    display:none;
    text-align:center;
    margin-top:40px;
  }
  #cakeGif{
    width:300px;
    max-width:80%;
    opacity:0;
    transform: scale(0.5);
    transition: opacity 1.2s ease, transform 1.2s ease;
  }

  /* ğŸ‰ ä¸‹æ–¹è¨Šæ¯å’ŒæŒ‰éˆ• */
  #afterCake{
    display:none;
    text-align:center;
    margin-top:25px;
    font-size:clamp(22px,5vw,40px);
    animation: textZoomIn 2s forwards;
  }
  #buttons{
    margin-top:20px;
  }
  button{
    font-size:20px;
    padding:10px 20px;
    margin:10px;
    border:none;
    border-radius:8px;
    cursor:pointer;
    transition: transform 0.3s ease;
    color:#fff;
  }
  #likeBtn{ background:#ff6fa5; }
  #dislikeBtn{ background:#5aa9e6; position:relative; }

  #emojiOverlay{
    position:fixed;
    top:50%; left:50%;
    transform:translate(-50%,-50%) scale(0.5);
    font-size:120px;
    display:none;
    z-index:10;
    opacity:0;
    transition: all 1s ease;
  }
  .emojiConfetti{
    position:fixed;
    top:-50px;
    font-size:32px;
    animation: emojiFall linear forwards;
  }
  @keyframes emojiFall{
    to { transform: translateY(110vh) translateX(var(--drift,0px)); }
  }

  /* â›” è‡ªè¨‚æç¤ºæ¡† */
  #customAlertOverlay{
    position:fixed;
    top:0;left:0;right:0;bottom:0;
    background:rgba(0,0,0,0.5);
    display:none;
    align-items:center;
    justify-content:center;
    z-index:100;
  }
  #customAlertBox{
    background:#fff;
    padding:20px;
    border-radius:12px;
    max-width:300px;
    text-align:center;
    font-size:18px;
    color:#333;
    transform:scale(0.7);
    opacity:0;
    transition: all 0.4s ease;
  }
  #customAlertBox.show{
    transform:scale(1);
    opacity:1;
  }
  #alertOk{
    margin-top:15px;
    padding:8px 16px;
    background:#ff6fa5;
    border:none;
    border-radius:6px;
    color:#fff;
    cursor:pointer;
  }
</style>
</head>
<body>

<audio id="bgm" autoplay loop>
  <source src="blessing.mp3" type="audio/mpeg">
</audio>

<!-- ğŸ‚ è›‹ç³• + æŒ‰éˆ•å€ -->
<div id="cakeWrapper">
  <img id="cakeGif" src="Cake1.gif" />
</div>
<div id="afterCake">
  <div>ãŠèª•ç”Ÿæ—¥ãŠã‚ã§ã¨ã†</div>
  <div id="buttons">
    <button id="likeBtn">æˆ‘å¾ˆå–œæ­¡</button>
    <button id="dislikeBtn">æˆ‘ä¸å–œæ­¡</button>
  </div>
</div>
<div id="emojiOverlay">ğŸ¥º</div>

<!-- â›” è‡ªè¨‚æç¤ºæ¡† -->
<div id="customAlertOverlay">
  <div id="customAlertBox">
    <div id="customAlertMsg"></div>
    <button id="alertOk">å¥½å§</button>
  </div>
</div>

<script>
const bgm = document.getElementById('bgm');
const wantA = localStorage.getItem('bgmAllowed') === 'true';
const wantB = localStorage.getItem('bgmPlaying') === 'true';
if (wantA || wantB) {
  bgm.play().catch(()=>{ console.log('bgm.play() è¢«é˜»æ“‹'); });
}

const messages = [
  "å˜¿ï½èŠèŒ‰å¦²çµ²",
  "ä»Šå¤©æ˜¯å±¬æ–¼",
  "ğŸ«µğŸ»ğŸ«µğŸ»ä½ ğŸ«µğŸ»ğŸ«µğŸ»",
  "ç‰¹åˆ¥æ—¥å­ï¼ï¼ï¼",
  "æº–å‚™å¥½äº†å—ï¼ŸğŸ§",
  "å°±ç®—é‚„æ²’ğŸ‘€",
  "ä¹Ÿçµ¦æˆ‘æº–å‚™å¥½ğŸ˜",
  "ä¸ç­‰ä½ çš„ğŸ¥³",
  "5","4","3","2","1"
];

let idx = 0;
const DURATION_NORMAL = 2000;
const DURATION_NUMBER = 2000;

function showNext(){
  if (idx >= messages.length) return;
  const txt = messages[idx];
  const isNumber = !isNaN(txt);

  const slide = document.createElement('div');
  slide.className = 'slide';

  const msg = document.createElement('div');
  msg.className = 'message ' + (isNumber ? 'number' : 'text');
  msg.textContent = txt;

  slide.appendChild(msg);
  document.body.appendChild(slide);

  const dur = isNumber ? DURATION_NUMBER : DURATION_NORMAL;
  setTimeout(()=> {
    slide.remove();
    idx++;
    showNext();
    if(idx === messages.length){ showCake(); }
  }, dur);
}
showNext();

function createConfetti(){
  const c = document.createElement('div');
  c.className = 'confetti';
  const colors = ["#ffd500","#ff69b4","#00bfff","#7cfc00","#ff4500","#ffffff"];
  c.style.background = colors[Math.floor(Math.random()*colors.length)];
  c.style.left = Math.random() * window.innerWidth + 'px';
  const size = Math.random() * 14 + 6;
  c.style.width = size + 'px';
  c.style.height = size + 'px';
  const drift = (Math.random()*260 - 130) + 'px';
  c.style.setProperty('--drift', drift);
  const duration = Math.random()*3 + 2;
  c.style.animationDuration = duration + 's';

  document.body.appendChild(c);
  setTimeout(()=> c.remove(), duration*1000 + 200);
}
setInterval(createConfetti, 120);

// ğŸ‚ é¡¯ç¤ºè›‹ç³•
function showCake(){
  const cakeWrapper = document.getElementById("cakeWrapper");
  const cakeGif = document.getElementById("cakeGif");
  cakeWrapper.style.display = "block";
  setTimeout(()=>{ 
    cakeGif.style.opacity = 1;
    cakeGif.style.transform = "scale(1)";
  },100);

  // Cake1.gif æ’­æ”¾ç´„ 10 ç§’å¾Œåˆ‡æ› Cake2.gif
  setTimeout(()=>{
    cakeGif.style.opacity = 0;
    setTimeout(()=>{
      cakeGif.src = "Cake2.gif";
      cakeGif.style.opacity = 1;
    },800);
  },10000);

  // 15 ç§’å¾Œé¡¯ç¤ºè¨Šæ¯å’ŒæŒ‰éˆ•
  setTimeout(()=>{
    document.getElementById("afterCake").style.display = "block";
  },15000);
}

// ğŸ‰ æŒ‰éˆ•äº’å‹•
const likeBtn = document.getElementById("likeBtn");
const dislikeBtn = document.getElementById("dislikeBtn");
const emojiOverlay = document.getElementById("emojiOverlay");
let dislikeCount = 0;

dislikeBtn.addEventListener("click",()=>{
  dislikeCount++;

  // æŒ‰éˆ•æ•ˆæœ
  likeBtn.style.transform = `scale(${1+dislikeCount*0.2})`;
  dislikeBtn.style.transform = "scale(0.8)";
  dislikeBtn.style.left = Math.random()*60 - 30 + "vw";
  dislikeBtn.style.top = Math.random()*60 - 30 + "vh";

  // 3 æ¬¡ â†’ å‡ºç¾ ğŸ¥º
  if(dislikeCount===3){
    emojiOverlay.textContent="ğŸ¥º";
    emojiOverlay.style.display="block";
    setTimeout(()=>{
      emojiOverlay.style.opacity=1;
      emojiOverlay.style.transform="translate(-50%,-50%) scale(1)";
    },50);
  }
  // 4 æ¬¡ä»¥ä¸Š â†’ æ‰è½ ğŸ¥¹
  if(dislikeCount>=4){
    const e = document.createElement("div");
    e.className="emojiConfetti";
    e.textContent="ğŸ¥¹";
    e.style.left = Math.random()*100+"vw";
    const drift=(Math.random()*200-100)+"px";
    e.style.setProperty("--drift",drift);
    e.style.animationDuration=(Math.random()*3+2)+"s";
    document.body.appendChild(e);
    setTimeout(()=>e.remove(),4000);

    // 6 æ¬¡ â†’ è‡ªè¨‚æç¤ºæ¡†
    if(dislikeCount===6){
      showCustomAlert("é€™æ¨£è²æˆˆæˆˆå°±æ˜¯äº†ï¼ŸğŸ¥¹<br>å¾Œé¢é‚„æœ‰æ±è¥¿æ¬¸â˜¹ï¸");
    }
  }
});

likeBtn.addEventListener("click",()=>{
  emojiOverlay.textContent="ğŸ¤ª";
  emojiOverlay.style.opacity=1;
  emojiOverlay.style.display="block";
});

// â›” è‡ªè¨‚æç¤ºæ¡†
const customAlertOverlay = document.getElementById("customAlertOverlay");
const customAlertBox = document.getElementById("customAlertBox");
const customAlertMsg = document.getElementById("customAlertMsg");
const alertOk = document.getElementById("alertOk");

function showCustomAlert(msg){
  customAlertMsg.innerHTML = msg;
  customAlertOverlay.style.display="flex";
  setTimeout(()=> customAlertBox.classList.add("show"),50);
}

alertOk.addEventListener("click",()=>{
  customAlertOverlay.style.display="none";
  customAlertBox.classList.remove("show");
});
</script>
</body>
</html>
